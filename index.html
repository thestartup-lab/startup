<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <meta name="theme-color" content="#1e40af">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>創業人格心理測驗</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Microsoft JhengHei", sans-serif;
            background: linear-gradient(135deg, #1e3a8a 0%, #312e81 100%);
            min-height: 100vh;
            padding: 20px;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            -webkit-tap-highlight-color: transparent;
            touch-action: manipulation;
        }

        html {
            scroll-behavior: smooth;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 24px;
            box-shadow: 0 25px 80px rgba(0, 0, 0, 0.35);
            overflow: hidden;
            animation: slideIn 0.5s ease-out;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .header {
            background: linear-gradient(135deg, #1e40af 0%, #4c1d95 100%);
            color: white;
            padding: 50px 40px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, transparent 30%, rgba(255,255,255,0.1) 50%, transparent 70%);
            animation: shine 3s infinite;
        }

        @keyframes shine {
            0%, 100% { transform: translateX(-100%); }
            50% { transform: translateX(100%); }
        }

        .header h1 {
            font-size: 2.25rem;
            margin-bottom: 12px;
            font-weight: 700;
            letter-spacing: -0.5px;
            position: relative;
            z-index: 1;
        }

        .header p {
            opacity: 0.95;
            font-size: 1.15rem;
            font-weight: 300;
            position: relative;
            z-index: 1;
        }

        .content {
            padding: 50px 40px;
        }

        .intro-section {
            margin-bottom: 30px;
        }

        .intro-section h2 {
            margin-bottom: 25px;
            color: #111827;
            font-size: 1.75rem;
            font-weight: 600;
        }

        .type-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .type-card {
            background: linear-gradient(145deg, #ffffff 0%, #f9fafb 100%);
            padding: 24px;
            border-radius: 16px;
            border: 1px solid #e5e7eb;
            border-left: 5px solid;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05);
        }

        .type-card:hover {
            transform: translateY(-8px) scale(1.02);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.15);
        }

        .type-card.type-a { border-left-color: #f59e0b; }
        .type-card.type-b { border-left-color: #10b981; }
        .type-card.type-c { border-left-color: #3b82f6; }
        .type-card.type-d { border-left-color: #ec4899; }

        .type-card h3 {
            font-size: 0.875rem;
            color: #9ca3af;
            margin-bottom: 8px;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .type-card .name {
            font-size: 1.25rem;
            font-weight: 700;
            color: #111827;
            margin-bottom: 10px;
            line-height: 1.3;
        }

        .type-card .trait {
            font-size: 0.9rem;
            color: #6b7280;
            line-height: 1.5;
        }

        .quiz-section {
            display: none;
        }

        .progress-bar {
            background: #e5e7eb;
            height: 8px;
            border-radius: 4px;
            margin-bottom: 30px;
            overflow: hidden;
        }

        .progress-fill {
            background: linear-gradient(90deg, #1e40af, #6366f1);
            height: 100%;
            width: 0%;
            transition: width 0.3s ease;
        }

        .question {
            background: linear-gradient(145deg, #ffffff 0%, #f9fafb 100%);
            padding: 30px;
            border-radius: 16px;
            margin-bottom: 24px;
            border: 1px solid #e5e7eb;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
        }

        .question h3 {
            color: #111827;
            margin-bottom: 20px;
            font-size: 1.15rem;
            line-height: 1.7;
            font-weight: 600;
        }

        .question-number {
            display: inline-block;
            background: #1e40af;
            color: white;
            padding: 2px 10px;
            border-radius: 12px;
            font-size: 0.85rem;
            margin-right: 8px;
            font-weight: 500;
        }

        .options {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .option {
            background: white;
            padding: 18px 20px;
            border-radius: 12px;
            border: 2px solid #e5e7eb;
            cursor: pointer;
            transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            display: flex;
            align-items: center;
            user-select: none;
            -webkit-user-select: none;
        }

        .option:hover {
            border-color: #3b82f6;
            transform: translateX(8px);
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.15);
        }

        .option input[type="radio"] {
            margin-right: 12px;
            cursor: pointer;
            width: 18px;
            height: 18px;
            accent-color: #1e40af;
            flex-shrink: 0;
        }

        .option input[type="radio"]:checked ~ label {
            font-weight: 600;
            color: #1e40af;
        }

        .option:has(input[type="radio"]:checked) {
            border-color: #1e40af;
            background: linear-gradient(145deg, #eff6ff 0%, #dbeafe 100%);
            box-shadow: 0 4px 12px rgba(30, 64, 175, 0.2);
        }

        .option label {
            cursor: pointer;
            display: flex;
            align-items: center;
            line-height: 1.5;
            flex: 1;
            width: 100%;
        }

        .btn {
            background: linear-gradient(135deg, #1e40af 0%, #4c1d95 100%);
            color: white;
            border: none;
            padding: 18px 40px;
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            width: 100%;
            margin-top: 24px;
            box-shadow: 0 10px 25px rgba(30, 64, 175, 0.3);
            position: relative;
            overflow: hidden;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }

        .btn:hover::before {
            left: 100%;
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 35px rgba(30, 64, 175, 0.4);
        }

        .btn:active {
            transform: translateY(-1px);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .result-section {
            display: none;
            animation: slideIn 0.5s ease-out;
        }

        .result-box {
            background: linear-gradient(135deg, #1e40af 0%, #4c1d95 100%);
            color: white;
            padding: 50px;
            border-radius: 20px;
            text-align: center;
            margin-bottom: 35px;
            position: relative;
            overflow: hidden;
            box-shadow: 0 20px 40px rgba(30, 64, 175, 0.3);
        }

        .result-box::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
        }

        .result-box h2 {
            font-size: 2.25rem;
            margin-bottom: 12px;
            font-weight: 700;
            position: relative;
            z-index: 1;
        }

        .result-box .subtitle {
            font-size: 1.25rem;
            opacity: 0.95;
            margin-bottom: 20px;
            font-weight: 300;
            position: relative;
            z-index: 1;
        }

        .result-details {
            background: linear-gradient(145deg, #ffffff 0%, #f9fafb 100%);
            padding: 35px;
            border-radius: 16px;
            margin-bottom: 24px;
            border: 1px solid #e5e7eb;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
        }

        .result-details h3 {
            color: #111827;
            margin-bottom: 20px;
            font-size: 1.35rem;
            font-weight: 600;
        }

        .result-details p {
            color: #4b5563;
            line-height: 1.8;
            margin-bottom: 15px;
            font-size: 1.05rem;
        }

        .score-bar {
            margin: 25px 0;
        }

        .score-item {
            margin-bottom: 20px;
        }

        .score-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: 0.95rem;
            color: #4b5563;
            font-weight: 500;
        }

        .bar {
            background: #e5e7eb;
            height: 28px;
            border-radius: 14px;
            overflow: hidden;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.06);
        }

        .bar-fill {
            height: 100%;
            border-radius: 14px;
            transition: width 0.8s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            align-items: center;
            justify-content: flex-end;
            padding-right: 12px;
            color: white;
            font-size: 0.9rem;
            font-weight: 700;
            box-shadow: 0 2px 8px rgba(0,0,0,0.15);
        }

        .bar-fill.type-a {
            background: linear-gradient(90deg, #f59e0b, #fbbf24);
            box-shadow: 0 2px 12px rgba(245, 158, 11, 0.4);
        }
        .bar-fill.type-b {
            background: linear-gradient(90deg, #10b981, #34d399);
            box-shadow: 0 2px 12px rgba(16, 185, 129, 0.4);
        }
        .bar-fill.type-c {
            background: linear-gradient(90deg, #3b82f6, #60a5fa);
            box-shadow: 0 2px 12px rgba(59, 130, 246, 0.4);
        }
        .bar-fill.type-d {
            background: linear-gradient(90deg, #ec4899, #f472b6);
            box-shadow: 0 2px 12px rgba(236, 72, 153, 0.4);
        }

        .note {
            background: linear-gradient(145deg, #fef3c7, #fde68a);
            border-left: 5px solid #f59e0b;
            padding: 18px 20px;
            border-radius: 12px;
            margin: 25px 0;
            color: #92400e;
            font-size: 0.95rem;
            line-height: 1.6;
            box-shadow: 0 2px 8px rgba(245, 158, 11, 0.1);
        }

        .note strong {
            color: #78350f;
            font-weight: 600;
        }

        @media (max-width: 768px) {
            body {
                padding: 12px;
            }

            .container {
                border-radius: 20px;
            }

            .header {
                padding: 40px 28px;
            }

            .header h1 {
                font-size: 1.85rem;
            }

            .header p {
                font-size: 1.05rem;
            }

            .content {
                padding: 35px 24px;
            }

            .intro-section h2 {
                font-size: 1.6rem;
            }

            .type-cards {
                grid-template-columns: 1fr;
                gap: 16px;
            }

            .type-card {
                padding: 20px;
            }

            .question {
                padding: 24px 20px;
                margin-bottom: 20px;
            }

            .question h3 {
                font-size: 1.08rem;
                margin-bottom: 18px;
            }

            .option {
                padding: 16px 18px;
            }

            .result-box {
                padding: 40px 28px;
            }

            .result-box h2 {
                font-size: 1.85rem;
            }

            .result-details {
                padding: 28px 24px;
            }

            .btn {
                padding: 17px 32px;
                font-size: 1.05rem;
            }
        }

        @media (max-width: 480px) {
            body {
                padding: 8px;
            }

            .container {
                border-radius: 16px;
            }

            .header {
                padding: 32px 20px;
            }

            .header h1 {
                font-size: 1.5rem;
                line-height: 1.3;
            }

            .header p {
                font-size: 0.95rem;
            }

            .content {
                padding: 28px 18px;
            }

            .intro-section h2 {
                font-size: 1.35rem;
                margin-bottom: 20px;
            }

            .type-cards {
                gap: 14px;
                margin: 20px 0;
            }

            .type-card {
                padding: 18px;
            }

            .type-card h3 {
                font-size: 0.8rem;
            }

            .type-card .name {
                font-size: 1.1rem;
            }

            .type-card .trait {
                font-size: 0.85rem;
            }

            .type-card:hover {
                transform: translateY(-4px) scale(1);
            }

            .progress-bar {
                height: 6px;
                margin-bottom: 24px;
            }

            .question {
                padding: 20px 16px;
                margin-bottom: 16px;
            }

            .question h3 {
                font-size: 1rem;
                margin-bottom: 16px;
                line-height: 1.6;
            }

            .question-number {
                font-size: 0.75rem;
                padding: 2px 8px;
                margin-right: 6px;
            }

            .options {
                gap: 10px;
            }

            .option {
                padding: 14px 16px;
            }

            .option:hover {
                transform: translateX(4px);
            }

            .option input[type="radio"] {
                width: 16px;
                height: 16px;
                margin-right: 10px;
            }

            .option label {
                font-size: 0.95rem;
                line-height: 1.4;
            }

            .result-box {
                padding: 32px 20px;
                border-radius: 16px;
                margin-bottom: 24px;
            }

            .result-box h2 {
                font-size: 1.5rem;
                margin-bottom: 10px;
            }

            .result-box .subtitle {
                font-size: 1.05rem;
            }

            .result-details {
                padding: 24px 18px;
                border-radius: 14px;
                margin-bottom: 18px;
            }

            .result-details h3 {
                font-size: 1.2rem;
                margin-bottom: 16px;
            }

            .result-details p {
                font-size: 0.95rem;
                line-height: 1.7;
            }

            .score-bar {
                margin: 20px 0;
            }

            .score-item {
                margin-bottom: 16px;
            }

            .score-label {
                font-size: 0.85rem;
                margin-bottom: 6px;
            }

            .bar {
                height: 24px;
            }

            .bar-fill {
                font-size: 0.8rem;
                padding-right: 8px;
            }

            .note {
                padding: 16px 18px;
                font-size: 0.9rem;
                margin: 20px 0;
            }

            .btn {
                padding: 15px 28px;
                font-size: 1rem;
                margin-top: 20px;
                border-radius: 10px;
            }

            .btn:hover {
                transform: translateY(-2px);
            }
        }

        /* 觸摸設備優化 */
        @media (hover: none) and (pointer: coarse) {
            .option {
                padding: 16px 18px;
                min-height: 48px;
            }

            .option:hover {
                transform: none;
                border-color: #e5e7eb;
            }

            .option:active {
                background: #f3f4f6;
                transform: scale(0.98);
            }

            .type-card:hover {
                transform: none;
            }

            .type-card:active {
                transform: scale(0.98);
            }

            .btn:hover {
                transform: none;
                box-shadow: 0 10px 25px rgba(30, 64, 175, 0.3);
            }

            .btn:active {
                transform: scale(0.98);
            }

            /* 禁用動畫以提升觸摸設備性能 */
            .header::before {
                animation: none;
            }

            .btn::before {
                animation: none;
            }
        }

        /* 橫屏模式優化 */
        @media (max-width: 896px) and (orientation: landscape) {
            .header {
                padding: 28px 30px;
            }

            .header h1 {
                font-size: 1.5rem;
            }

            .header p {
                font-size: 0.95rem;
            }

            .content {
                padding: 32px 28px;
            }

            .question {
                padding: 20px;
            }

            .result-box {
                padding: 32px 28px;
            }
        }

        /* 極小螢幕優化 (iPhone SE 等) */
        @media (max-width: 375px) {
            .header h1 {
                font-size: 1.35rem;
            }

            .header p {
                font-size: 0.9rem;
            }

            .intro-section h2 {
                font-size: 1.25rem;
            }

            .type-card {
                padding: 16px;
            }

            .type-card .name {
                font-size: 1.05rem;
            }

            .question h3 {
                font-size: 0.95rem;
            }

            .question-number {
                font-size: 0.7rem;
                padding: 1px 6px;
            }

            .option {
                padding: 12px 14px;
            }

            .option label {
                font-size: 0.9rem;
            }

            .result-box h2 {
                font-size: 1.35rem;
            }

            .result-details h3 {
                font-size: 1.1rem;
            }

            .result-details p {
                font-size: 0.9rem;
            }
        }

        /* 管理模式樣式 */
        .admin-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            z-index: 9999;
            backdrop-filter: blur(8px);
        }

        .admin-modal {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            border-radius: 20px;
            padding: 40px;
            max-width: 500px;
            width: 90%;
            box-shadow: 0 25px 80px rgba(0, 0, 0, 0.5);
            z-index: 10000;
        }

        .admin-modal h2 {
            color: #111827;
            margin-bottom: 20px;
            text-align: center;
            font-size: 1.75rem;
        }

        .admin-modal input {
            width: 100%;
            padding: 15px 20px;
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            font-size: 1.1rem;
            margin-bottom: 20px;
            transition: border-color 0.3s;
        }

        .admin-modal input:focus {
            outline: none;
            border-color: #1e40af;
        }

        .admin-modal .btn-group {
            display: flex;
            gap: 12px;
        }

        .admin-modal .btn {
            flex: 1;
            margin: 0;
        }

        .btn-secondary {
            background: linear-gradient(135deg, #6b7280 0%, #4b5563 100%);
        }

        .admin-panel {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: white;
            z-index: 9998;
            overflow-y: auto;
            padding: 40px 20px;
        }

        .admin-header {
            max-width: 1200px;
            margin: 0 auto 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px;
            background: linear-gradient(135deg, #1e40af 0%, #4c1d95 100%);
            border-radius: 16px;
            color: white;
        }

        .admin-header h2 {
            margin: 0;
            font-size: 1.75rem;
        }

        .admin-content {
            max-width: 1200px;
            margin: 0 auto;
        }

        .question-item {
            background: linear-gradient(145deg, #ffffff 0%, #f9fafb 100%);
            border: 1px solid #e5e7eb;
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 20px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
        }

        .question-item input,
        .question-item textarea {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e5e7eb;
            border-radius: 10px;
            font-size: 1rem;
            margin-bottom: 12px;
            font-family: inherit;
        }

        .question-item input:focus,
        .question-item textarea:focus {
            outline: none;
            border-color: #1e40af;
        }

        .question-item textarea {
            resize: vertical;
            min-height: 60px;
        }

        .option-input-group {
            display: grid;
            grid-template-columns: 60px 1fr 140px;
            gap: 10px;
            align-items: center;
            margin-bottom: 10px;
        }

        .option-input-group label {
            font-weight: 600;
            color: #4b5563;
        }

        .option-input-group select {
            padding: 8px 12px;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            font-size: 0.95rem;
            cursor: pointer;
            background: white;
        }

        .option-input-group select:focus {
            outline: none;
            border-color: #1e40af;
        }

        .btn-danger {
            background: linear-gradient(135deg, #dc2626 0%, #b91c1c 100%);
        }

        .btn-success {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
        }

        .admin-actions {
            display: flex;
            gap: 12px;
            margin-top: 16px;
        }

        .admin-actions .btn {
            flex: 1;
            margin: 0;
            padding: 12px 20px;
            font-size: 0.95rem;
        }

        .sync-panel {
            max-width: 1200px;
            margin: 20px auto;
            padding: 24px;
            background: linear-gradient(145deg, #eff6ff 0%, #dbeafe 100%);
            border: 2px solid #3b82f6;
            border-radius: 16px;
        }

        .sync-panel h3 {
            color: #1e40af;
            margin-bottom: 16px;
            font-size: 1.3rem;
        }

        .sync-panel .input-group {
            margin-bottom: 16px;
        }

        .sync-panel label {
            display: block;
            font-weight: 600;
            color: #374151;
            margin-bottom: 8px;
        }

        .sync-panel input {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e5e7eb;
            border-radius: 10px;
            font-size: 1rem;
        }

        .sync-panel input:focus {
            outline: none;
            border-color: #3b82f6;
        }

        .sync-panel .btn-group {
            display: flex;
            gap: 12px;
            margin-top: 16px;
        }

        .sync-panel .btn-group .btn {
            flex: 1;
            margin: 0;
        }

        .sync-status {
            padding: 12px 16px;
            border-radius: 10px;
            margin-top: 16px;
            font-size: 0.95rem;
        }

        .sync-status.success {
            background: #d1fae5;
            color: #065f46;
            border: 1px solid #10b981;
        }

        .sync-status.error {
            background: #fee2e2;
            color: #991b1b;
            border: 1px solid #dc2626;
        }

        .sync-status.info {
            background: #dbeafe;
            color: #1e40af;
            border: 1px solid #3b82f6;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🌪️ 創業人格心理測驗</h1>
            <p>你是哪一種創業者？</p>
            <button onclick="showAdminLogin()" style="position: absolute; top: 20px; right: 20px; background: rgba(255,255,255,0.2); border: 1px solid rgba(255,255,255,0.3); color: white; padding: 8px 16px; border-radius: 8px; cursor: pointer; font-size: 0.9rem; transition: all 0.3s;">🔐 管理</button>
        </div>

        <div class="content">
            <!-- 介紹部分 -->
            <div class="intro-section" id="intro">
                <div style="text-align: center; padding: 40px 20px;">
                    <h2 style="font-size: 2rem; margin-bottom: 20px; color: #111827; font-weight: 700;">每個創業者都有獨特的超能力</h2>
                    <p style="font-size: 1.2rem; line-height: 1.8; color: #4b5563; max-width: 600px; margin: 0 auto 30px;">
                        發現你的創業人格，放大你的天賦優勢，<br>找到最適合你的夥伴組合。
                    </p>
                    <div style="display: flex; justify-content: center; gap: 20px; margin: 40px 0; flex-wrap: wrap;">
                        <div style="text-align: center;">
                            <div style="font-size: 3rem; margin-bottom: 8px;">✨</div>
                            <div style="color: #6b7280; font-size: 0.9rem;">願景驅動</div>
                        </div>
                        <div style="text-align: center;">
                            <div style="font-size: 3rem; margin-bottom: 8px;">🔨</div>
                            <div style="color: #6b7280; font-size: 0.9rem;">執行為王</div>
                        </div>
                        <div style="text-align: center;">
                            <div style="font-size: 3rem; margin-bottom: 8px;">🎯</div>
                            <div style="color: #6b7280; font-size: 0.9rem;">策略制勝</div>
                        </div>
                        <div style="text-align: center;">
                            <div style="font-size: 3rem; margin-bottom: 8px;">🤝</div>
                            <div style="color: #6b7280; font-size: 0.9rem;">關係取勝</div>
                        </div>
                    </div>
                </div>

                <button class="btn" onclick="startQuiz()">開始測驗</button>
            </div>

            <!-- 測驗部分 -->
            <div class="quiz-section" id="quiz">
                <div class="progress-bar">
                    <div class="progress-fill" id="progressBar"></div>
                </div>
                <form id="quizForm">
                    <div class="question">
                        <h3><span class="question-number">Q1</span>創業初期，你最先想到的是：</h3>
                        <div class="options">
                            <div class="option">
                                <input type="radio" name="q1" value="A" id="q1a">
                                <label for="q1a">想像品牌形象和故事</label>
                            </div>
                            <div class="option">
                                <input type="radio" name="q1" value="B" id="q1b">
                                <label for="q1b">先找辦公室和組團隊</label>
                            </div>
                            <div class="option">
                                <input type="radio" name="q1" value="C" id="q1c">
                                <label for="q1c">設定長期策略與風險預案</label>
                            </div>
                            <div class="option">
                                <input type="radio" name="q1" value="D" id="q1d">
                                <label for="q1d">想到誰能幫我拉投資或宣傳</label>
                            </div>
                        </div>
                    </div>

                    <div class="question">
                        <h3><span class="question-number">Q2</span>你面對資金短缺時會：</h3>
                        <div class="options">
                            <div class="option">
                                <input type="radio" name="q2" value="A" id="q2a">
                                <label for="q2a">做出新企劃吸引人支持</label>
                            </div>
                            <div class="option">
                                <input type="radio" name="q2" value="B" id="q2b">
                                <label for="q2b">立刻削減成本撐住現金流</label>
                            </div>
                            <div class="option">
                                <input type="radio" name="q2" value="C" id="q2c">
                                <label for="q2c">重新計算模型、改變商業模式</label>
                            </div>
                            <div class="option">
                                <input type="radio" name="q2" value="D" id="q2d">
                                <label for="q2d">動員人脈拉贊助或合夥</label>
                            </div>
                        </div>
                    </div>

                    <div class="question">
                        <h3><span class="question-number">Q3</span>團隊裡出現紛爭時你通常：</h3>
                        <div class="options">
                            <div class="option">
                                <input type="radio" name="q3" value="A" id="q3a">
                                <label for="q3a">用願景激勵大家冷靜下來</label>
                            </div>
                            <div class="option">
                                <input type="radio" name="q3" value="B" id="q3b">
                                <label for="q3b">親自介入、分工明確解決問題</label>
                            </div>
                            <div class="option">
                                <input type="radio" name="q3" value="C" id="q3c">
                                <label for="q3c">觀察後再做精準調整</label>
                            </div>
                            <div class="option">
                                <input type="radio" name="q3" value="D" id="q3d">
                                <label for="q3d">開聊喝咖啡、讓氣氛化解矛盾</label>
                            </div>
                        </div>
                    </div>

                    <div class="question">
                        <h3><span class="question-number">Q4</span>你最享受創業的哪一部分？</h3>
                        <div class="options">
                            <div class="option">
                                <input type="radio" name="q4" value="A" id="q4a">
                                <label for="q4a">創造新的品牌概念</label>
                            </div>
                            <div class="option">
                                <input type="radio" name="q4" value="B" id="q4b">
                                <label for="q4b">實際看到產品完成</label>
                            </div>
                            <div class="option">
                                <input type="radio" name="q4" value="C" id="q4c">
                                <label for="q4c">把市場策略玩到極致</label>
                            </div>
                            <div class="option">
                                <input type="radio" name="q4" value="D" id="q4d">
                                <label for="q4d">與人建立連結、拓展圈子</label>
                            </div>
                        </div>
                    </div>

                    <div class="question">
                        <h3><span class="question-number">Q5</span>投資人問你未來三年計畫：</h3>
                        <div class="options">
                            <div class="option">
                                <input type="radio" name="q5" value="A" id="q5a">
                                <label for="q5a">描述理想世界和公司願景</label>
                            </div>
                            <div class="option">
                                <input type="radio" name="q5" value="B" id="q5b">
                                <label for="q5b">拿出完整里程碑和KPI</label>
                            </div>
                            <div class="option">
                                <input type="radio" name="q5" value="C" id="q5c">
                                <label for="q5c">展示Excel模型和風險分析</label>
                            </div>
                            <div class="option">
                                <input type="radio" name="q5" value="D" id="q5d">
                                <label for="q5d">強調合作夥伴與市場機會</label>
                            </div>
                        </div>
                    </div>

                    <div class="question">
                        <h3><span class="question-number">Q6</span>面對失敗，你會：</h3>
                        <div class="options">
                            <div class="option">
                                <input type="radio" name="q6" value="A" id="q6a">
                                <label for="q6a">當作故事的一部分，繼續宣傳</label>
                            </div>
                            <div class="option">
                                <input type="radio" name="q6" value="B" id="q6b">
                                <label for="q6b">快速歸納問題、立刻再試</label>
                            </div>
                            <div class="option">
                                <input type="radio" name="q6" value="C" id="q6c">
                                <label for="q6c">寫報告分析原因,下次避開</label>
                            </div>
                            <div class="option">
                                <input type="radio" name="q6" value="D" id="q6d">
                                <label for="q6d">跟朋友聚會吐苦水，順便找新機會</label>
                            </div>
                        </div>
                    </div>

                    <div class="question">
                        <h3><span class="question-number">Q7</span>若你能雇一個人幫忙，會選：</h3>
                        <div class="options">
                            <div class="option">
                                <input type="radio" name="q7" value="A" id="q7a">
                                <label for="q7a">設計師或品牌顧問</label>
                            </div>
                            <div class="option">
                                <input type="radio" name="q7" value="B" id="q7b">
                                <label for="q7b">營運長或專案經理</label>
                            </div>
                            <div class="option">
                                <input type="radio" name="q7" value="C" id="q7c">
                                <label for="q7c">財務或策略顧問</label>
                            </div>
                            <div class="option">
                                <input type="radio" name="q7" value="D" id="q7d">
                                <label for="q7d">公關或社群經理</label>
                            </div>
                        </div>
                    </div>

                    <div class="question">
                        <h3><span class="question-number">Q8</span>你對「創業成功」的定義是：</h3>
                        <div class="options">
                            <div class="option">
                                <input type="radio" name="q8" value="A" id="q8a">
                                <label for="q8a">改變世界、留下名字</label>
                            </div>
                            <div class="option">
                                <input type="radio" name="q8" value="B" id="q8b">
                                <label for="q8b">公司穩定、員工幸福</label>
                            </div>
                            <div class="option">
                                <input type="radio" name="q8" value="C" id="q8c">
                                <label for="q8c">精準控制市場與成長曲線</label>
                            </div>
                            <div class="option">
                                <input type="radio" name="q8" value="D" id="q8d">
                                <label for="q8d">有影響力、認識許多厲害的人</label>
                            </div>
                        </div>
                    </div>

                    <div class="question">
                        <h3><span class="question-number">Q9</span>當你構想新產品：</h3>
                        <div class="options">
                            <div class="option">
                                <input type="radio" name="q9" value="A" id="q9a">
                                <label for="q9a">從「這東西會多吸引人」開始</label>
                            </div>
                            <div class="option">
                                <input type="radio" name="q9" value="B" id="q9b">
                                <label for="q9b">從「怎麼生產最有效率」開始</label>
                            </div>
                            <div class="option">
                                <input type="radio" name="q9" value="C" id="q9c">
                                <label for="q9c">從「市場缺口在哪」開始</label>
                            </div>
                            <div class="option">
                                <input type="radio" name="q9" value="D" id="q9d">
                                <label for="q9d">從「我能找誰合作」開始</label>
                            </div>
                        </div>
                    </div>

                    <div class="question">
                        <h3><span class="question-number">Q10</span>你喜歡的工作環境：</h3>
                        <div class="options">
                            <div class="option">
                                <input type="radio" name="q10" value="A" id="q10a">
                                <label for="q10a">充滿創意與自由</label>
                            </div>
                            <div class="option">
                                <input type="radio" name="q10" value="B" id="q10b">
                                <label for="q10b">條理分明、進度明確</label>
                            </div>
                            <div class="option">
                                <input type="radio" name="q10" value="C" id="q10c">
                                <label for="q10c">安靜、可思考與分析</label>
                            </div>
                            <div class="option">
                                <input type="radio" name="q10" value="D" id="q10d">
                                <label for="q10d">熱鬧、有很多人互動</label>
                            </div>
                        </div>
                    </div>

                    <div class="question">
                        <h3><span class="question-number">Q11</span>當別人批評你的點子：</h3>
                        <div class="options">
                            <div class="option">
                                <input type="radio" name="q11" value="A" id="q11a">
                                <label for="q11a">覺得他們不懂夢想</label>
                            </div>
                            <div class="option">
                                <input type="radio" name="q11" value="B" id="q11b">
                                <label for="q11b">記下來改進</label>
                            </div>
                            <div class="option">
                                <input type="radio" name="q11" value="C" id="q11c">
                                <label for="q11c">問「依據是什麼？」</label>
                            </div>
                            <div class="option">
                                <input type="radio" name="q11" value="D" id="q11d">
                                <label for="q11d">嘗試從他身上找支持</label>
                            </div>
                        </div>
                    </div>

                    <div class="question">
                        <h3><span class="question-number">Q12</span>你的最大優勢是：</h3>
                        <div class="options">
                            <div class="option">
                                <input type="radio" name="q12" value="A" id="q12a">
                                <label for="q12a">激勵人、讓人相信</label>
                            </div>
                            <div class="option">
                                <input type="radio" name="q12" value="B" id="q12b">
                                <label for="q12b">執行快、有紀律</label>
                            </div>
                            <div class="option">
                                <input type="radio" name="q12" value="C" id="q12c">
                                <label for="q12c">看得遠、分析準</label>
                            </div>
                            <div class="option">
                                <input type="radio" name="q12" value="D" id="q12d">
                                <label for="q12d">人脈廣、會講話</label>
                            </div>
                        </div>
                    </div>

                    <button type="button" class="btn" onclick="calculateResult()">查看結果</button>
                </form>
            </div>

            <!-- 結果部分 -->
            <div class="result-section" id="result">
                <div class="result-box">
                    <h2 id="resultType"></h2>
                    <div class="subtitle" id="resultSubtitle"></div>
                </div>

                <div class="result-details">
                    <h3>📊 你的分數分布</h3>
                    <div class="score-bar" id="scoreBar"></div>
                </div>

                <div class="result-details">
                    <h3>💡 類型解析</h3>
                    <div id="typeDescription"></div>
                </div>

                <button class="btn" onclick="resetQuiz()">重新測驗</button>
            </div>
        </div>
    </div>

    <!-- 管理模式 UI -->
    <div class="admin-overlay" id="adminOverlay">
        <div class="admin-modal">
            <h2>🔐 管理員登入</h2>
            <input type="password" id="adminPassword" placeholder="請輸入密碼" autocomplete="off">
            <div class="btn-group">
                <button class="btn btn-secondary" onclick="closeAdminLogin()">取消</button>
                <button class="btn" onclick="verifyAdminPassword()">確認</button>
            </div>
        </div>
    </div>

    <div class="admin-panel" id="adminPanel">
        <div class="admin-header">
            <h2>📝 題目管理系統</h2>
            <div style="display: flex; gap: 12px;">
                <button class="btn btn-danger" onclick="resetToDefault()" style="margin: 0; padding: 12px 20px; font-size: 0.9rem;">🔄 重置為預設</button>
                <button class="btn btn-secondary" onclick="exitAdminMode()" style="margin: 0; padding: 12px 24px;">退出管理</button>
            </div>
        </div>

        <!-- 密碼修改區 -->
        <div class="sync-panel" style="background: linear-gradient(145deg, #fef3c7 0%, #fde68a 100%); border-color: #f59e0b;">
            <h3 style="color: #92400e;">🔒 修改管理密碼</h3>
            <div style="padding: 12px 16px; background: rgba(146, 64, 14, 0.1); border-radius: 8px; margin-bottom: 16px; font-size: 0.9rem; color: #92400e;">
                ⚠️ <strong>注意：</strong>必須先設定 GitHub Token 和 Gist ID 才能修改密碼。若未設定 Gist，密碼將固定為預設值 <code style="background: rgba(0,0,0,0.1); padding: 2px 6px; border-radius: 4px; font-weight: 600;">12345</code>
            </div>
            <div class="input-group">
                <label for="currentPassword">當前密碼</label>
                <input type="password" id="currentPassword" placeholder="請輸入當前密碼" autocomplete="off">
            </div>
            <div class="input-group">
                <label for="newPassword">新密碼</label>
                <input type="password" id="newPassword" placeholder="請輸入新密碼" autocomplete="off">
            </div>
            <div class="input-group">
                <label for="confirmPassword">確認新密碼</label>
                <input type="password" id="confirmPassword" placeholder="再次輸入新密碼" autocomplete="off">
            </div>
            <button class="btn" onclick="changeAdminPassword()" style="background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%); width: 100%; margin-top: 0;">🔑 更改密碼</button>
            <div id="passwordStatus"></div>
        </div>

        <!-- GitHub Gist 同步設置 -->
        <div class="sync-panel">
            <h3>☁️ GitHub Gist 雲端同步</h3>
            <div class="input-group">
                <label for="githubToken">GitHub Personal Access Token</label>
                <input type="password" id="githubToken" placeholder="ghp_xxxxxxxxxxxxxxxxxxxx" autocomplete="off">
                <small style="color: #6b7280; font-size: 0.85rem; margin-top: 4px; display: block;">
                    需要 'gist' 權限。<a href="https://github.com/settings/tokens/new?scopes=gist&description=Quiz%20Sync" target="_blank" style="color: #3b82f6;">點此創建 Token</a>
                </small>
            </div>
            <div class="input-group">
                <label for="gistId">Gist ID (選填，留空將自動創建)</label>
                <input type="text" id="gistId" placeholder="例如: abc123def456..." autocomplete="off">
                <small style="color: #6b7280; font-size: 0.85rem; margin-top: 4px; display: block;">
                    首次使用請留空，系統會自動創建一個 private gist
                </small>
            </div>
            <div class="btn-group">
                <button class="btn btn-success" onclick="saveGitHubConfig()">💾 儲存設定</button>
                <button class="btn" onclick="pullFromGist()" style="background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);">⬇️ 從雲端拉取</button>
                <button class="btn" onclick="pushToGist()" style="background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%);">⬆️ 推送到雲端</button>
            </div>
            <div id="syncStatus"></div>
        </div>

        <div style="max-width: 1200px; margin: 20px auto; padding: 16px 20px; background: #fef3c7; border-left: 5px solid #f59e0b; border-radius: 12px; color: #92400e; font-size: 0.95rem;">
            <strong>💡 提示：</strong>使用 GitHub Gist 同步後，題目和管理密碼將儲存在雲端。網頁開啟時會自動從雲端拉取最新資料。修改題目後記得推送到雲端，修改密碼會自動推送。
        </div>
        <div style="max-width: 1200px; margin: 20px auto; padding: 16px 20px; background: #dbeafe; border-left: 5px solid #3b82f6; border-radius: 12px; color: #1e40af; font-size: 0.95rem;">
            <strong>🔄 自動同步機制：</strong>
            <ul style="margin-top: 8px; margin-left: 20px; line-height: 1.8;">
                <li>每次開啟網頁時，會自動從雲端拉取最新題目和密碼</li>
                <li>在管理模式中修改題目後，請點擊「儲存」然後「推送到雲端」</li>
                <li>其他人重新整理網頁即可看到最新內容</li>
            </ul>
        </div>
        <div style="max-width: 1200px; margin: 20px auto; padding: 16px 20px; background: #f3e8ff; border-left: 5px solid #a855f7; border-radius: 12px; color: #6b21a8; font-size: 0.95rem;">
            <strong>🎯 人格類型配置：</strong>每個選項可以獨立設定對應的人格類型。例如：第1題的選項A可以對應「B-實幹型」，不一定要對應「A-夢想型」。
        </div>
        <div class="admin-content" id="adminContent">
            <!-- 題目列表將動態生成 -->
        </div>
        <div style="max-width: 1200px; margin: 30px auto;">
            <button class="btn btn-success" onclick="addNewQuestion()">➕ 新增題目</button>
        </div>
    </div>

    <script>
        const typeInfo = {
            A: {
                name: '夢想型 Visionary',
                emoji: '✨',
                description: '喜歡創新、講故事、創造潮流。天生品牌掌舵人，但可能缺乏紀律與財務耐心。你擅長用願景激勵他人，將抽象概念轉化為令人興奮的故事。你的創意和靈感是團隊的引擎，但記得要找到實幹型夥伴來幫你落地執行。'
            },
            B: {
                name: '實幹型 Builder',
                emoji: '🔨',
                description: '行動派。你會每天讓公司前進一點。穩定、可靠、能把夢想變成現實，但有時太保守。你是執行大師，擅長將計畫轉化為具體行動，並確保每個細節都到位。你的紀律性和效率是創業成功的關鍵，但偶爾也要敢於冒險創新。'
            },
            C: {
                name: '策略型 Strategist',
                emoji: '🎯',
                description: '理性派企業家。你擅長規劃與風控，但容易陷入過度分析。適合做B2B或大型系統創業。你能看到別人看不到的機會和風險，用數據和邏輯做決策。你的分析能力是公司的指南針，但記得有時候行動比完美的計畫更重要。'
            },
            D: {
                name: '社交型 Connector',
                emoji: '🤝',
                description: '靠關係起飛，對市場脈動敏感。你是公關、行銷、商業聯盟的靈魂，但可能缺乏專注力。你天生擅長建立人脈，能快速找到合適的合作夥伴和資源。你的社交能力能為公司打開無數扇門，但要記得保持專注，不要被太多機會分散注意力。'
            }
        };

        // 默認題目數據
        const defaultQuestions = [
            {
                id: 1,
                text: "創業初期，你最先想到的是：",
                options: [
                    { value: "A", text: "想像品牌形象和故事", type: "A" },
                    { value: "B", text: "先找辦公室和組團隊", type: "B" },
                    { value: "C", text: "設定長期策略與風險預案", type: "C" },
                    { value: "D", text: "想到誰能幫我拉投資或宣傳", type: "D" }
                ]
            },
            {
                id: 2,
                text: "你面對資金短缺時會：",
                options: [
                    { value: "A", text: "做出新企劃吸引人支持", type: "A" },
                    { value: "B", text: "立刻削減成本撐住現金流", type: "B" },
                    { value: "C", text: "重新計算模型、改變商業模式", type: "C" },
                    { value: "D", text: "動員人脈拉贊助或合夥", type: "D" }
                ]
            },
            {
                id: 3,
                text: "團隊裡出現紛爭時你通常：",
                options: [
                    { value: "A", text: "用願景激勵大家冷靜下來", type: "A" },
                    { value: "B", text: "親自介入、分工明確解決問題", type: "B" },
                    { value: "C", text: "觀察後再做精準調整", type: "C" },
                    { value: "D", text: "開聊喝咖啡、讓氣氛化解矛盾", type: "D" }
                ]
            },
            {
                id: 4,
                text: "你最享受創業的哪一部分？",
                options: [
                    { value: "A", text: "創造新的品牌概念", type: "A" },
                    { value: "B", text: "實際看到產品完成", type: "B" },
                    { value: "C", text: "把市場策略玩到極致", type: "C" },
                    { value: "D", text: "與人建立連結、拓展圈子", type: "D" }
                ]
            },
            {
                id: 5,
                text: "投資人問你未來三年計畫：",
                options: [
                    { value: "A", text: "描述理想世界和公司願景", type: "A" },
                    { value: "B", text: "拿出完整里程碑和KPI", type: "B" },
                    { value: "C", text: "展示Excel模型和風險分析", type: "C" },
                    { value: "D", text: "強調合作夥伴與市場機會", type: "D" }
                ]
            },
            {
                id: 6,
                text: "面對失敗，你會：",
                options: [
                    { value: "A", text: "當作故事的一部分，繼續宣傳", type: "A" },
                    { value: "B", text: "快速歸納問題、立刻再試", type: "B" },
                    { value: "C", text: "寫報告分析原因,下次避開", type: "C" },
                    { value: "D", text: "跟朋友聚會吐苦水，順便找新機會", type: "D" }
                ]
            },
            {
                id: 7,
                text: "若你能雇一個人幫忙，會選：",
                options: [
                    { value: "A", text: "設計師或品牌顧問", type: "A" },
                    { value: "B", text: "營運長或專案經理", type: "B" },
                    { value: "C", text: "財務或策略顧問", type: "C" },
                    { value: "D", text: "公關或社群經理", type: "D" }
                ]
            },
            {
                id: 8,
                text: "你對「創業成功」的定義是：",
                options: [
                    { value: "A", text: "改變世界、留下名字", type: "A" },
                    { value: "B", text: "公司穩定、員工幸福", type: "B" },
                    { value: "C", text: "精準控制市場與成長曲線", type: "C" },
                    { value: "D", text: "有影響力、認識許多厲害的人", type: "D" }
                ]
            },
            {
                id: 9,
                text: "當你構想新產品：",
                options: [
                    { value: "A", text: "從「這東西會多吸引人」開始", type: "A" },
                    { value: "B", text: "從「怎麼生產最有效率」開始", type: "B" },
                    { value: "C", text: "從「市場缺口在哪」開始", type: "C" },
                    { value: "D", text: "從「我能找誰合作」開始", type: "D" }
                ]
            },
            {
                id: 10,
                text: "你喜歡的工作環境：",
                options: [
                    { value: "A", text: "充滿創意與自由", type: "A" },
                    { value: "B", text: "條理分明、進度明確", type: "B" },
                    { value: "C", text: "安靜、可思考與分析", type: "C" },
                    { value: "D", text: "熱鬧、有很多人互動", type: "D" }
                ]
            },
            {
                id: 11,
                text: "當別人批評你的點子：",
                options: [
                    { value: "A", text: "覺得他們不懂夢想", type: "A" },
                    { value: "B", text: "記下來改進", type: "B" },
                    { value: "C", text: "問「依據是什麼？」", type: "C" },
                    { value: "D", text: "嘗試從他身上找支持", type: "D" }
                ]
            },
            {
                id: 12,
                text: "你的最大優勢是：",
                options: [
                    { value: "A", text: "激勵人、讓人相信", type: "A" },
                    { value: "B", text: "執行快、有紀律", type: "B" },
                    { value: "C", text: "看得遠、分析準", type: "C" },
                    { value: "D", text: "人脈廣、會講話", type: "D" }
                ]
            }
        ];

        // 從 localStorage 載入或使用默認題目
        function loadQuestions() {
            const saved = localStorage.getItem('quizQuestions');
            return saved ? JSON.parse(saved) : defaultQuestions;
        }

        // 保存題目到 localStorage
        function saveQuestions(questions) {
            localStorage.setItem('quizQuestions', JSON.stringify(questions));
        }

        let currentQuestions = loadQuestions();

        function startQuiz() {
            document.getElementById('intro').style.display = 'none';
            document.getElementById('quiz').style.display = 'block';
            smoothScrollToTop();
            updateProgress();
        }

        function smoothScrollToTop() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function updateProgress() {
            const form = document.getElementById('quizForm');
            let answeredCount = 0;
            const totalQuestions = currentQuestions.length;

            currentQuestions.forEach(q => {
                const answer = form.querySelector(`input[name="q${q.id}"]:checked`);
                if (answer) answeredCount++;
            });

            const percentage = (answeredCount / totalQuestions) * 100;
            document.getElementById('progressBar').style.width = percentage + '%';
        }

        // 初始化選項監聽器
        function initializeOptionListeners() {
            const allRadios = document.querySelectorAll('input[type="radio"]');
            allRadios.forEach(radio => {
                radio.addEventListener('change', updateProgress);
            });

            // 讓整個選項卡片可點擊
            const options = document.querySelectorAll('.option');
            options.forEach(option => {
                option.addEventListener('click', function(e) {
                    // 如果點擊的不是 radio button 或 label，手動選中
                    if (e.target.tagName !== 'INPUT' && e.target.tagName !== 'LABEL') {
                        const radio = this.querySelector('input[type="radio"]');
                        if (radio) {
                            radio.checked = true;
                            updateProgress();
                        }
                    }
                });
            });

            // 添加觸摸反饋
            if ('ontouchstart' in window) {
                options.forEach(option => {
                    option.addEventListener('touchstart', function() {
                        this.style.opacity = '0.7';
                    }, { passive: true });

                    option.addEventListener('touchend', function() {
                        this.style.opacity = '1';
                    }, { passive: true });
                });

                const buttons = document.querySelectorAll('.btn');
                buttons.forEach(btn => {
                    btn.addEventListener('touchstart', function() {
                        this.style.opacity = '0.8';
                    }, { passive: true });

                    btn.addEventListener('touchend', function() {
                        this.style.opacity = '1';
                    }, { passive: true });
                });
            }
        }

        // 頁面載入時初始化
        document.addEventListener('DOMContentLoaded', async function() {
            // 先嘗試從雲端拉取最新資料
            await autoSyncOnLoad();

            // 檢查是否有自定義題目
            const saved = localStorage.getItem('quizQuestions');
            if (saved) {
                currentQuestions = JSON.parse(saved);
                regenerateQuizForm();
            }

            // 初始化監聽器
            initializeOptionListeners();
        });

        // 頁面載入時自動同步
        async function autoSyncOnLoad() {
            const token = localStorage.getItem('githubToken');
            const gistId = localStorage.getItem('gistId');

            // 如果沒有設定 Token 或 Gist ID，則跳過自動同步
            if (!token || !gistId) {
                console.log('未設定 GitHub Token 或 Gist ID，跳過自動同步');
                return;
            }

            try {
                const response = await fetch(`https://api.github.com/gists/${gistId}`, {
                    headers: {
                        'Authorization': `token ${token}`,
                        'Accept': 'application/vnd.github.v3+json'
                    }
                });

                if (!response.ok) {
                    console.error('自動同步失敗:', response.status, response.statusText);
                    return;
                }

                const gist = await response.json();

                // 拉取題目
                if (gist.files['quiz-questions.json']) {
                    const questionsContent = gist.files['quiz-questions.json'].content;
                    const questions = JSON.parse(questionsContent);
                    currentQuestions = questions;
                    saveQuestions(currentQuestions);
                    console.log(`✅ 自動同步成功：已載入 ${currentQuestions.length} 道題目`);
                }

                // 拉取密碼雜湊
                if (gist.files['admin-password.json']) {
                    const passwordContent = gist.files['admin-password.json'].content;
                    const passwordData = JSON.parse(passwordContent);
                    localStorage.setItem('adminPasswordHash', passwordData.passwordHash);
                    console.log('✅ 已同步管理密碼');
                }
            } catch (error) {
                console.error('自動同步失敗:', error);
                // 失敗時不顯示錯誤訊息，靜默失敗，使用本地資料
            }
        }

        function calculateResult() {
            const form = document.getElementById('quizForm');
            const scores = { A: 0, B: 0, C: 0, D: 0 };

            // 檢查是否所有問題都已回答（使用實際的題目 ID）
            const totalQuestions = currentQuestions.length;
            let answeredCount = 0;

            for (let i = 0; i < currentQuestions.length; i++) {
                const q = currentQuestions[i];
                const answer = form.querySelector(`input[name="q${q.id}"]:checked`);
                if (!answer) {
                    alert(`請回答第 ${i + 1} 題`);
                    return;
                }

                // 根據選項的 type 而非 value 來計分
                const selectedValue = answer.value;
                const selectedOption = q.options.find(opt => opt.value === selectedValue);
                const personalityType = selectedOption.type || selectedValue; // 向後兼容

                scores[personalityType]++;
                answeredCount++;
            }

            // 找出最高分和次高分
            const sortedScores = Object.entries(scores).sort((a, b) => b[1] - a[1]);
            const primaryType = sortedScores[0][0];
            const primaryScore = sortedScores[0][1];
            const secondaryType = sortedScores[1][0];
            const secondaryScore = sortedScores[1][1];

            // 判斷是否為混合型（根據題目數量動態調整閾值）
            // 12題差2分 = 16.7%，所以用 20% 作為閾值
            const mixedThreshold = Math.ceil(totalQuestions * 0.2);
            const isMixed = (primaryScore - secondaryScore) <= mixedThreshold;

            // 顯示結果
            displayResult(primaryType, secondaryType, isMixed, scores, totalQuestions);
        }

        function displayResult(primaryType, secondaryType, isMixed, scores, totalQuestions) {
            document.getElementById('quiz').style.display = 'none';
            document.getElementById('result').style.display = 'block';
            smoothScrollToTop();

            // 設置標題
            const resultTypeEl = document.getElementById('resultType');
            const resultSubtitleEl = document.getElementById('resultSubtitle');

            if (isMixed) {
                resultTypeEl.textContent = `${typeInfo[primaryType].emoji} ${typeInfo[primaryType].name} + ${typeInfo[secondaryType].name}`;
                resultSubtitleEl.textContent = '混合型創業者';
            } else {
                resultTypeEl.textContent = `${typeInfo[primaryType].emoji} ${typeInfo[primaryType].name}`;
                resultSubtitleEl.textContent = '你的創業人格類型';
            }

            // 繪製分數條
            const scoreBarEl = document.getElementById('scoreBar');
            scoreBarEl.innerHTML = '';

            const typeLabels = {
                A: '夢想型 Visionary',
                B: '實幹型 Builder',
                C: '策略型 Strategist',
                D: '社交型 Connector'
            };

            Object.entries(scores).forEach(([type, score]) => {
                const percentage = (score / totalQuestions) * 100;
                const scoreItem = document.createElement('div');
                scoreItem.className = 'score-item';
                scoreItem.innerHTML = `
                    <div class="score-label">
                        <span>${typeLabels[type]}</span>
                        <span>${score}/${totalQuestions}</span>
                    </div>
                    <div class="bar">
                        <div class="bar-fill type-${type.toLowerCase()}" style="width: ${percentage}%">
                            ${score > 0 ? score : ''}
                        </div>
                    </div>
                `;
                scoreBarEl.appendChild(scoreItem);
            });

            // 顯示類型描述
            const descriptionEl = document.getElementById('typeDescription');
            if (isMixed) {
                descriptionEl.innerHTML = `
                    <p><strong>${typeInfo[primaryType].name}：</strong>${typeInfo[primaryType].description}</p>
                    <p style="margin-top: 15px;"><strong>${typeInfo[secondaryType].name}：</strong>${typeInfo[secondaryType].description}</p>
                    <div class="note" style="margin-top: 20px;">
                        你是混合型創業者！你同時具備這兩種類型的特質，這讓你更加全面和靈活。善用這個優勢，你可以在不同情境下切換不同的模式。
                    </div>
                `;
            } else {
                descriptionEl.innerHTML = `<p>${typeInfo[primaryType].description}</p>`;
            }
        }

        function resetQuiz() {
            document.getElementById('result').style.display = 'none';
            document.getElementById('intro').style.display = 'block';
            document.getElementById('quizForm').reset();
            document.getElementById('progressBar').style.width = '0%';
            smoothScrollToTop();
        }

        // ========== 管理模式功能 ==========

        // SHA-256 雜湊函數
        async function sha256(message) {
            const msgBuffer = new TextEncoder().encode(message);
            const hashBuffer = await crypto.subtle.digest('SHA-256', msgBuffer);
            const hashArray = Array.from(new Uint8Array(hashBuffer));
            const hashHex = hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
            return hashHex;
        }

        // 顯示管理員登入對話框
        function showAdminLogin() {
            document.getElementById('adminOverlay').style.display = 'block';
            document.getElementById('adminPassword').value = '';
            document.getElementById('adminPassword').focus();
        }

        // 關閉登入對話框
        function closeAdminLogin() {
            document.getElementById('adminOverlay').style.display = 'none';
        }

        // 驗證管理員密碼
        async function verifyAdminPassword() {
            const password = document.getElementById('adminPassword').value;
            const passwordHash = await sha256(password);

            // 預設密碼 12345 的 SHA-256
            const defaultHash = '5994471abb01112afcc18159f6cc74b4f511b99806da59b3caf5a9c173cacfc5';

            // 只有在設定了 Gist 的情況下才使用 localStorage 的密碼
            const gistId = localStorage.getItem('gistId');
            const savedHash = gistId ? (localStorage.getItem('adminPasswordHash') || defaultHash) : defaultHash;

            if (passwordHash === savedHash) {
                closeAdminLogin();
                enterAdminMode();
            } else {
                alert('密碼錯誤！');
                document.getElementById('adminPassword').value = '';
            }
        }

        // 進入管理模式
        function enterAdminMode() {
            document.getElementById('adminPanel').style.display = 'block';
            loadGitHubConfig();
            renderAdminQuestions();
        }

        // 退出管理模式
        function exitAdminMode() {
            if (confirm('確定要退出管理模式嗎？')) {
                document.getElementById('adminPanel').style.display = 'none';
                // 重新載入頁面以應用更改
                location.reload();
            }
        }

        // 重置為預設題目
        function resetToDefault() {
            if (confirm('確定要重置為預設題目嗎？所有自訂題目將被清除！')) {
                localStorage.removeItem('quizQuestions');
                currentQuestions = [...defaultQuestions];
                saveQuestions(currentQuestions);
                renderAdminQuestions();
                alert('已重置為預設題目！');
            }
        }

        // ========== GitHub Gist 同步功能 ==========

        // 載入 GitHub 設定
        function loadGitHubConfig() {
            const token = localStorage.getItem('githubToken');
            const gistId = localStorage.getItem('gistId');
            if (token) document.getElementById('githubToken').value = token;
            if (gistId) document.getElementById('gistId').value = gistId;
        }

        // 儲存 GitHub 設定
        function saveGitHubConfig() {
            const token = document.getElementById('githubToken').value.trim();
            const gistId = document.getElementById('gistId').value.trim();

            if (!token) {
                showSyncStatus('請輸入 GitHub Token！', 'error');
                return;
            }

            localStorage.setItem('githubToken', token);
            if (gistId) {
                localStorage.setItem('gistId', gistId);
            }

            showSyncStatus('設定已儲存！', 'success');
        }

        // 顯示同步狀態
        function showSyncStatus(message, type = 'info') {
            const statusDiv = document.getElementById('syncStatus');
            statusDiv.className = `sync-status ${type}`;
            statusDiv.textContent = message;
            statusDiv.style.display = 'block';

            if (type === 'success') {
                setTimeout(() => {
                    statusDiv.style.display = 'none';
                }, 3000);
            }
        }

        // 修改管理密碼
        async function changeAdminPassword() {
            const currentPassword = document.getElementById('currentPassword').value;
            const newPassword = document.getElementById('newPassword').value;
            const confirmPassword = document.getElementById('confirmPassword').value;
            const statusDiv = document.getElementById('passwordStatus');

            // 檢查是否已設定 Gist
            const token = localStorage.getItem('githubToken');
            const gistId = localStorage.getItem('gistId');

            if (!token || !gistId) {
                statusDiv.className = 'sync-status error';
                statusDiv.textContent = '❌ 請先設定 GitHub Token 和 Gist ID 才能修改密碼！';
                statusDiv.style.display = 'block';
                return;
            }

            if (!currentPassword || !newPassword || !confirmPassword) {
                statusDiv.className = 'sync-status error';
                statusDiv.textContent = '請填寫所有欄位！';
                statusDiv.style.display = 'block';
                return;
            }

            // 驗證當前密碼
            const currentPasswordHash = await sha256(currentPassword);
            const defaultHash = '5994471abb01112afcc18159f6cc74b4f511b99806da59b3caf5a9c173cacfc5'; // 12345
            const savedHash = localStorage.getItem('adminPasswordHash') || defaultHash;

            if (currentPasswordHash !== savedHash) {
                statusDiv.className = 'sync-status error';
                statusDiv.textContent = '當前密碼錯誤！';
                statusDiv.style.display = 'block';
                return;
            }

            if (newPassword !== confirmPassword) {
                statusDiv.className = 'sync-status error';
                statusDiv.textContent = '新密碼與確認密碼不符！';
                statusDiv.style.display = 'block';
                return;
            }

            if (newPassword.length < 4) {
                statusDiv.className = 'sync-status error';
                statusDiv.textContent = '密碼長度至少需要 4 個字元！';
                statusDiv.style.display = 'block';
                return;
            }

            // 將新密碼雜湊後儲存
            const newPasswordHash = await sha256(newPassword);
            localStorage.setItem('adminPasswordHash', newPasswordHash);

            statusDiv.className = 'sync-status success';
            statusDiv.textContent = '✅ 密碼已成功更改！正在推送到雲端...';
            statusDiv.style.display = 'block';

            document.getElementById('currentPassword').value = '';
            document.getElementById('newPassword').value = '';
            document.getElementById('confirmPassword').value = '';

            // 自動推送密碼到雲端
            await pushPasswordToGist();
        }

        // 從 Gist 拉取題目和密碼
        async function pullFromGist() {
            const token = localStorage.getItem('githubToken');
            const gistId = localStorage.getItem('gistId');

            if (!token) {
                showSyncStatus('請先設定 GitHub Token！', 'error');
                return;
            }

            if (!gistId) {
                showSyncStatus('請先推送題目到雲端或輸入現有的 Gist ID！', 'error');
                return;
            }

            showSyncStatus('正在從雲端拉取資料...', 'info');

            try {
                const response = await fetch(`https://api.github.com/gists/${gistId}`, {
                    headers: {
                        'Authorization': `token ${token}`,
                        'Accept': 'application/vnd.github.v3+json'
                    }
                });

                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }

                const gist = await response.json();

                // 拉取題目
                if (gist.files['quiz-questions.json']) {
                    const questionsContent = gist.files['quiz-questions.json'].content;
                    const questions = JSON.parse(questionsContent);
                    currentQuestions = questions;
                    saveQuestions(currentQuestions);
                    renderAdminQuestions();
                }

                // 拉取密碼雜湊
                if (gist.files['admin-password.json']) {
                    const passwordContent = gist.files['admin-password.json'].content;
                    const passwordData = JSON.parse(passwordContent);
                    localStorage.setItem('adminPasswordHash', passwordData.passwordHash);
                }

                showSyncStatus(`✅ 成功拉取 ${currentQuestions.length} 道題目和密碼設定！`, 'success');
            } catch (error) {
                console.error('拉取失敗:', error);
                showSyncStatus(`❌ 拉取失敗: ${error.message}`, 'error');
            }
        }

        // 推送題目和密碼到 Gist
        async function pushToGist() {
            const token = localStorage.getItem('githubToken');
            let gistId = localStorage.getItem('gistId');

            if (!token) {
                showSyncStatus('請先設定 GitHub Token！', 'error');
                return;
            }

            showSyncStatus('正在推送資料到雲端...', 'info');

            const defaultHash = '5994471abb01112afcc18159f6cc74b4f511b99806da59b3caf5a9c173cacfc5'; // 12345
            const passwordHash = localStorage.getItem('adminPasswordHash') || defaultHash;

            const gistData = {
                description: '創業人格心理測驗 - 題目數據與管理密碼',
                public: false,
                files: {
                    'quiz-questions.json': {
                        content: JSON.stringify(currentQuestions, null, 2)
                    },
                    'admin-password.json': {
                        content: JSON.stringify({
                            passwordHash: passwordHash,
                            lastUpdated: new Date().toISOString()
                        }, null, 2)
                    }
                }
            };

            try {
                let response;

                if (gistId) {
                    // 更新現有 Gist
                    response = await fetch(`https://api.github.com/gists/${gistId}`, {
                        method: 'PATCH',
                        headers: {
                            'Authorization': `token ${token}`,
                            'Accept': 'application/vnd.github.v3+json',
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify(gistData)
                    });
                } else {
                    // 創建新 Gist
                    response = await fetch('https://api.github.com/gists', {
                        method: 'POST',
                        headers: {
                            'Authorization': `token ${token}`,
                            'Accept': 'application/vnd.github.v3+json',
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify(gistData)
                    });
                }

                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }

                const result = await response.json();

                // 儲存 Gist ID
                if (!gistId) {
                    gistId = result.id;
                    localStorage.setItem('gistId', gistId);
                    document.getElementById('gistId').value = gistId;
                    showSyncStatus(`✅ 已創建雲端同步！Gist ID: ${gistId}\n成功推送 ${currentQuestions.length} 道題目和密碼設定！`, 'success');
                } else {
                    showSyncStatus(`✅ 成功推送 ${currentQuestions.length} 道題目和密碼設定到雲端！`, 'success');
                }
            } catch (error) {
                console.error('推送失敗:', error);
                showSyncStatus(`❌ 推送失敗: ${error.message}`, 'error');
            }
        }

        // 單獨推送密碼到 Gist (修改密碼時使用)
        async function pushPasswordToGist() {
            const token = localStorage.getItem('githubToken');
            const gistId = localStorage.getItem('gistId');

            if (!token || !gistId) {
                document.getElementById('passwordStatus').textContent += '\n⚠️ 密碼已在本地更改，但未推送到雲端（請先設定 GitHub Token 和 Gist ID）';
                return;
            }

            const defaultHash = '5994471abb01112afcc18159f6cc74b4f511b99806da59b3caf5a9c173cacfc5';
            const passwordHash = localStorage.getItem('adminPasswordHash') || defaultHash;

            try {
                const response = await fetch(`https://api.github.com/gists/${gistId}`, {
                    method: 'PATCH',
                    headers: {
                        'Authorization': `token ${token}`,
                        'Accept': 'application/vnd.github.v3+json',
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        files: {
                            'admin-password.json': {
                                content: JSON.stringify({
                                    passwordHash: passwordHash,
                                    lastUpdated: new Date().toISOString()
                                }, null, 2)
                            }
                        }
                    })
                });

                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }

                const statusDiv = document.getElementById('passwordStatus');
                statusDiv.textContent = '✅ 密碼已成功更改並同步到雲端！';

                setTimeout(() => {
                    statusDiv.style.display = 'none';
                }, 3000);
            } catch (error) {
                console.error('推送密碼失敗:', error);
                document.getElementById('passwordStatus').textContent += `\n⚠️ 密碼已在本地更改，但推送到雲端失敗: ${error.message}`;
            }
        }

        // 渲染管理界面的題目列表
        function renderAdminQuestions() {
            const container = document.getElementById('adminContent');
            container.innerHTML = '';

            const typeOptions = `
                <option value="A">A - 夢想型</option>
                <option value="B">B - 實幹型</option>
                <option value="C">C - 策略型</option>
                <option value="D">D - 社交型</option>
            `;

            currentQuestions.forEach((q, index) => {
                const questionHTML = `
                    <div class="question-item">
                        <h3 style="margin-bottom: 16px; color: #1e40af;">問題 ${index + 1}</h3>
                        <textarea placeholder="題目文字" data-id="${q.id}" data-field="text">${q.text}</textarea>

                        <div class="option-input-group">
                            <label>選項 A:</label>
                            <input type="text" placeholder="選項文字" value="${q.options[0].text}" data-id="${q.id}" data-option="0">
                            <select data-id="${q.id}" data-option="0" data-field="type">
                                ${typeOptions}
                            </select>
                        </div>
                        <div class="option-input-group">
                            <label>選項 B:</label>
                            <input type="text" placeholder="選項文字" value="${q.options[1].text}" data-id="${q.id}" data-option="1">
                            <select data-id="${q.id}" data-option="1" data-field="type">
                                ${typeOptions}
                            </select>
                        </div>
                        <div class="option-input-group">
                            <label>選項 C:</label>
                            <input type="text" placeholder="選項文字" value="${q.options[2].text}" data-id="${q.id}" data-option="2">
                            <select data-id="${q.id}" data-option="2" data-field="type">
                                ${typeOptions}
                            </select>
                        </div>
                        <div class="option-input-group">
                            <label>選項 D:</label>
                            <input type="text" placeholder="選項文字" value="${q.options[3].text}" data-id="${q.id}" data-option="3">
                            <select data-id="${q.id}" data-option="3" data-field="type">
                                ${typeOptions}
                            </select>
                        </div>

                        <div class="admin-actions">
                            <button class="btn btn-success" onclick="saveQuestion(${q.id})">💾 儲存</button>
                            <button class="btn btn-danger" onclick="deleteQuestion(${q.id})">🗑️ 刪除</button>
                        </div>
                    </div>
                `;
                container.innerHTML += questionHTML;

                // 設置選中的值
                setTimeout(() => {
                    for (let i = 0; i < 4; i++) {
                        const select = document.querySelector(`select[data-id="${q.id}"][data-option="${i}"]`);
                        if (select && q.options[i]) {
                            select.value = q.options[i].type || q.options[i].value;
                        }
                    }
                }, 0);
            });
        }

        // 儲存單個題目的更改
        function saveQuestion(questionId) {
            const questionIndex = currentQuestions.findIndex(q => q.id === questionId);
            if (questionIndex === -1) return;

            const textArea = document.querySelector(`textarea[data-id="${questionId}"]`);
            const optionInputs = document.querySelectorAll(`input[data-id="${questionId}"]`);
            const typeSelects = document.querySelectorAll(`select[data-id="${questionId}"][data-field="type"]`);

            currentQuestions[questionIndex].text = textArea.value;

            // 保存選項文字和對應人格類型
            optionInputs.forEach(input => {
                const optionIndex = parseInt(input.dataset.option);
                currentQuestions[questionIndex].options[optionIndex].text = input.value;
            });

            typeSelects.forEach(select => {
                const optionIndex = parseInt(select.dataset.option);
                currentQuestions[questionIndex].options[optionIndex].type = select.value;
            });

            saveQuestions(currentQuestions);
            alert('題目已儲存！');
        }

        // 刪除題目
        function deleteQuestion(questionId) {
            if (!confirm('確定要刪除這個題目嗎？')) return;

            currentQuestions = currentQuestions.filter(q => q.id !== questionId);
            // 重新編號
            currentQuestions.forEach((q, index) => {
                q.id = index + 1;
            });

            saveQuestions(currentQuestions);
            renderAdminQuestions();
            alert('題目已刪除！');
        }

        // 新增題目
        function addNewQuestion() {
            const newId = currentQuestions.length > 0 ? Math.max(...currentQuestions.map(q => q.id)) + 1 : 1;
            const newQuestion = {
                id: newId,
                text: "新題目（請編輯）",
                options: [
                    { value: "A", text: "選項 A（請編輯）", type: "A" },
                    { value: "B", text: "選項 B（請編輯）", type: "B" },
                    { value: "C", text: "選項 C（請編輯）", type: "C" },
                    { value: "D", text: "選項 D（請編輯）", type: "D" }
                ]
            };

            currentQuestions.push(newQuestion);
            saveQuestions(currentQuestions);
            renderAdminQuestions();

            // 滾動到新題目
            setTimeout(() => {
                const items = document.querySelectorAll('.question-item');
                items[items.length - 1].scrollIntoView({ behavior: 'smooth', block: 'center' });
            }, 100);
        }

        // 重新生成測驗表單（當題目數量改變時）
        function regenerateQuizForm() {
            const form = document.getElementById('quizForm');
            form.innerHTML = '';

            currentQuestions.forEach((q, index) => {
                const questionHTML = `
                    <div class="question">
                        <h3><span class="question-number">Q${index + 1}</span>${q.text}</h3>
                        <div class="options">
                            ${q.options.map(opt => `
                                <div class="option">
                                    <input type="radio" name="q${q.id}" value="${opt.value}" id="q${q.id}${opt.value.toLowerCase()}">
                                    <label for="q${q.id}${opt.value.toLowerCase()}">${opt.text}</label>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
                form.innerHTML += questionHTML;
            });

            form.innerHTML += '<button type="button" class="btn" onclick="calculateResult()">查看結果</button>';

            // 重新初始化監聽器
            initializeOptionListeners();
        }

        // 按 Enter 鍵提交密碼
        document.addEventListener('keypress', function(e) {
            if (e.key === 'Enter' && document.getElementById('adminOverlay').style.display === 'block') {
                verifyAdminPassword();
            }
        });
    </script>
</body>
</html>